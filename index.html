<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£</title>
    <!-- Enhanced Content Security Policy to reduce phishing risks -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://unpkg.com https://code.jquery.com https://opensheet.elk.sh https://docs.google.com https://script.google.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; font-src https://fonts.gstatic.com https://cdnjs.cloudflare.com; img-src 'self' data: https: blob:; connect-src 'self' https://opensheet.elk.sh https://docs.google.com https://script.google.com; frame-src https://docs.google.com; object-src 'none'; base-uri 'self'; form-action 'self' https://docs.google.com;">
    <!-- Additional security headers via meta -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <!-- Verification meta to help with Safe Browsing (add your site verification if available) -->
    <meta name="google-site-verification" content="your-verification-token-if-any">
    <!-- Clear description to indicate legitimacy -->
    <meta name="description" content="‡∏£‡∏∞‡∏ö‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£ - ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å">
    <link href="https://fonts.googleapis.com/css2?family=Itim&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <style>
      body {
        margin: 0;
        padding: 0;
        background-color: #eceff1;
        font-family: "Kanit", sans-serif;
      }
      .header {
        display: flex;
        justify-content: center;
        align-items: center;
        color: #1a3c87;
        padding: 10px 0;
        border-bottom: 2px solid #ff80ab;
        border-radius: 12px;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
        font-family: "Itim", cursive;
        overflow: hidden;
        position: relative;
        background: linear-gradient(135deg, #fff3e0, #ffebee);
        margin: 10px auto;
        max-width: 1500px;
        height: 52px;
        transition: transform 0.3s ease;
      }
      .header:hover {
        transform: translateY(-2px);
      }
      @keyframes slideRight {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
      }
      h1 {
        color: #1a3c87;
        margin: 0;
        font-size: 30px;
        font-weight: normal;
        text-shadow: 0.5px 0.5px 1px rgba(0, 0, 0, 0.1);
        animation: slideRight 20s linear infinite;
        white-space: nowrap;
        position: absolute;
  left: 0; /* ‚úÖ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î */
  width: 100%; /* ‚úÖ ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏° */
  text-align: center; /* ‚úÖ ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á */
  animation: slideRight 7s linear infinite;
  white-space: nowrap;
      }
      .container {
        max-width: 1500px;
        margin: 0 auto;
        padding: 15px;
        background-color: #ffffff;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        font-family: "Kanit", sans-serif;
      }
      .tabs {
        display: flex;
        margin-top: 5px;
        gap: 10px;
      }
      .tab-button {
        flex: 1;
        padding: 10px;
        text-align: center;
        background: linear-gradient(135deg, #42a5f5, #2196f3);
        color: white;
        cursor: pointer;
        border: none;
        outline: none;
        font-size: 18px;
        border-radius: 10px;
        transition: all 0.3s ease;
        font-family: "Kanit", sans-serif;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }
      .tab-button:hover {
        background: linear-gradient(135deg, #1976d2, #1565c0);
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
      }
      .tab-button.active {
        background: linear-gradient(135deg, #f06292, #ec407a);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        transform: translateY(-2px);
      }
      .tab-content {
        display: none;
        padding: 15px;
        background-color: #fafafa;
        border-radius: 10px;
        margin-top: 10px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
      }
      .tab-content.active {
        display: block;
      }
      .loading {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 22px;
        color: #2196f3;
        z-index: 9999;
        display: none;
      }
      iframe {
        width: 100%;
        height: 800px;
        border: none;
        border-radius: 10px;
      }
      .footer {
        background: linear-gradient(135deg, #0d47a1, #1565c0);
        color: white;
        text-align: center;
        padding: 10px 0;
        margin-top: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }
      .footer p {
        margin: 0;
        font-size: 14px;
      }
      .social-buttons {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 10px;
        padding: 10px;
      }
      .social-button {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        color: white;
        font-size: 18px;
        text-decoration: none;
        transition: all 0.3s ease;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      }
      .social-button:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      }
      .social-button.facebook {
        background: linear-gradient(135deg, #3b5998, #2a4373);
      }
      .social-button.tiktok {
        background: linear-gradient(135deg, #000000, #333333);
      }
      .social-button.telegram {
        background: linear-gradient(135deg, #26A5E4, #1b87b9);
      }
      .social-button.qrcode {
        background: linear-gradient(135deg, #4caf50, #388e3c);
      }
      @media screen and (max-width: 360px) {
        .social-button {
          width: 36px;
          height: 36px;
          font-size: 16px;
        }
        .social-buttons {
          gap: 8px;
        }
      }
      #parts, #today {
        font-family: "Poppins", sans-serif;
        background-color: #f0f4f8;
        padding: 15px;
        border-radius: 8px;
      }
      #parts #searchContainer, #today #searchContainer {
        display: flex;
        justify-content: flex-start;
        margin-bottom: 15px;
      }
      #parts #searchInput, #today #searchInputToday {
        width: 100%;
        max-width: 300px;
        padding: 10px;
        border-radius: 6px;
        border: 1px solid #e0e0e0;
        font-size: 15px;
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
      }
      #parts #searchInput:focus, #today #searchInputToday:focus {
        border-color: #2196f3;
        box-shadow: 0 0 5px rgba(33, 150, 243, 0.3);
        outline: none;
      }
      #parts .refresh-button {
        background: linear-gradient(135deg, #42a5f5, #2196f3);
        color: #fff;
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        font-size: 13px;
        font-weight: 500;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        margin-left: 10px;
      }
      #parts .refresh-button:hover {
        background: linear-gradient(135deg, #1976d2, #1565c0);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      }
      #parts table, #today table {
        width: 100%;
        border-collapse: collapse;
        background: #fff;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        overflow: hidden;
      }
      #parts th, #parts td, #today th, #today td {
        padding: 10px;
        text-align: center;
        border: 1px solid #e0e0e0;
        font-size: 15px;
      }
      #parts th, #today th {
        background: linear-gradient(135deg, #2196f3, #1976d2);
        color: white;
        position: sticky;
        top: 0;
        z-index: 1;
      }
      #parts tr:hover, #today tr:hover {
        background-color: #f5f5f5;
      }
      #parts .table-container, #today .table-container {
        max-height: 80vh;
        overflow-y: auto;
        overflow-x: auto;
        background: white;
        border-radius: 8px;
      }
      #parts .pagination {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        margin-top: 12px;
      }
      #parts .pagination button {
        background: linear-gradient(135deg, #42a5f5, #2196f3);
        color: white;
        padding: 8px;
        border: none;
        border-radius: 50%;
        margin: 0 5px;
        cursor: pointer;
        width: 36px;
        height: 36px;
        font-size: 13px;
        transition: all 0.3s ease;
      }
      #parts .pagination button:hover {
        background: linear-gradient(135deg, #1976d2, #1565c0);
        transform: translateY(-2px);
      }
      #parts .pagination .active {
        background: linear-gradient(135deg, #ff9800, #f57c00);
      }
      #parts .pagination button:disabled {
        background: #b0bec5;
        cursor: not-allowed;
      }
      #parts .pagination select {
        padding: 8px;
        border-radius: 6px;
        margin: 0 10px;
        font-size: 14px;
      }
      #parts .table-container, #today .table-container {
        overflow-x: auto;
        width: 100%;
      }
      #parts table, #today table {
        min-width: 900px;
      }
      #parts td, #today td {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      #parts td:nth-child(3), #today td:nth-child(4) {
        text-align: left;
      }
      #parts th:nth-child(4), #parts td:nth-child(4) {
        min-width: 300px;
      }
      #parts th:nth-child(5), #parts td:nth-child(5) {
        min-width: 50px;
      }
      #parts th:nth-child(6), #parts td:nth-child(6) {
        min-width: 50px;
      }
      #parts th:nth-child(7), #parts td:nth-child(7) {
        min-width: 250px;
      }
      #parts th:nth-child(8), #parts td:nth-child(8) {
        min-width: 150px;
      }
      #parts .requisition-button, #today .detail-button {
        background: linear-gradient(135deg, #4caf50, #388e3c);
        color: white;
        font-size: 13px;
        font-weight: 500;
        padding: 8px 16px;
        border: none;
        border-radius: 20px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
      }
      #parts .requisition-button:hover, #today .detail-button:hover {
        background: linear-gradient(135deg, #388e3c, #4caf50);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      }
      #parts .requisition-button:focus, #today .detail-button:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.3);
      }
      #parts .requisition-button:active, #today .detail-button:active {
        transform: translateY(1px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      #parts .swal2-input {
        margin: 4px 0;
        width: 100%;
        box-sizing: border-box;
        border-radius: 6px;
        font-size: 14px;
        padding: 6px;
        height: 36px;
      }
      #parts .swal2-select {
        margin: 4px 0;
        width: 100%;
        padding: 6px;
        box-sizing: border-box;
        border-radius: 6px;
        font-size: 14px;
        height: 36px;
      }
      #parts .swal2-label {
        font-weight: 500;
        margin: 8px 0 4px;
        display: block;
        text-align: left;
        font-size: 14px;
      }
      #parts .invalid-input {
        border: 2px solid #ef5350 !important;
        box-shadow: 0 0 5px rgba(239, 83, 80, 0.3);
      }
      #parts .error-message {
        color: #ef5350;
        font-size: 12px;
        margin-top: 2px;
        display: block;
        text-align: left;
      }
      #parts a {
        text-decoration: none;
        color: #2196f3;
        target="_blank" rel="noopener noreferrer";
      }
      #parts a:hover {
        color: #1565c0;
      }
      #parts img {
        transition: transform 0.2s ease;
      }
      #parts img:hover {
        transform: scale(1.1);
      }
      #today .status-green {
        color: #4caf50;
        font-weight: bold;
      }
      #today .status-red {
        color: #ef5350;
        font-weight: bold;
      }
      #today .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(4px);
        opacity: 0;
        transform: scale(0.95);
        transition: opacity 0.3s ease, transform 0.3s ease;
      }
      #today .modal-content {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(to bottom right, #ffffff, #f5f7fa);
        padding: 20px;
        border-radius: 12px;
        width: 90%;
        max-width: 500px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        animation: fadeIn 0.3s ease;
        font-family: "Poppins", sans-serif;
        z-index: 1001;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: scale(0.95); }
        to { opacity: 1; transform: scale(1); }
      }
      #today .close {
        color: #78909c;
        float: right;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
        transition: color 0.3s;
      }
      #today .close:hover {
        color: #e53935;
      }
      #today #modalContent {
        margin-top: 15px;
      }
      #today #modalContent div {
        padding: 10px 0;
        border-bottom: 1px solid #eceff1;
      }
      #today #modalContent div:last-child {
        border-bottom: none;
      }
      #today #modalContent span.label {
        display: inline-block;
        min-width: 120px;
        font-weight: 500;
        color: #2196f3;
        font-size: 15px;
      }
      #today #modalContent span.value {
        font-size: 15px;
        color: #37474f;
      }
      #today .modal-content h2 {
        color: #e91e63;
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 15px;
      }
      #today .spinner-container {
        text-align: center;
        padding: 40px 20px;
        color: #2196f3;
        font-size: 15px;
      }
      #today .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #eceff1;
        border-top: 4px solid #2196f3;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 10px auto;
      }
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      #error-container, #error-container-today {
        display: none;
        text-align: center;
        padding: 15px;
        color: #ef5350;
        font-size: 15px;
        background-color: #ffebee;
        border-radius: 8px;
        margin-bottom: 15px;
      }
      #retry-button, #retry-button-today {
        background: linear-gradient(135deg, #ff7043, #f44336);
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
        margin-top: 10px;
        transition: all 0.3s ease;
      }
      #retry-button:hover, #retry-button-today:hover {
        background: linear-gradient(135deg, #f44336, #ff7043);
        transform: translateY(-2px);
      }
      .swal2-container {
        position: fixed !important;
        z-index: 9999;
        overflow-y: auto;
        max-height: 80vh;
      }
      .swal2-popup {
        max-width: 320px !important;
        padding: 15px !important;
        font-size: 14px !important;
        border-radius: 10px !important;
      }
      .swal2-content {
        padding-bottom: 150px !important;
      }
      .swal2-title {
        font-size: 18px !important;
        margin-bottom: 10px !important;
      }
      .swal2-actions {
        margin-top: 10px !important;
      }
      .swal2-confirm, .swal2-cancel {
        font-size: 14px !important;
        padding: 8px 16px !important;
      }
      .swal2-confirm:disabled {
        background: #b0bec5 !important;
        cursor: not-allowed !important;
        opacity: 0.6;
      }
      .autocomplete-items {
        max-height: 120px;
        border-radius: 6px;
      }
      .autocomplete-item {
        padding: 6px;
        font-size: 14px;
      }
      .swal2-qrcode {
        display: block;
        margin: 10px auto;
        border: 1px solid #ddd;
        border-radius: 4px;
      }
      .swal2-spinner-container {
        text-align: center;
        padding: 20px;
        color: #2196f3;
        font-size: 15px;
      }
      .swal2-spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #eceff1;
        border-top: 4px solid #2196f3;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 10px auto;
      }
      @media screen and (max-width: 360px) {
        .swal2-popup {
          max-width: 300px !important;
        }
        .swal2-input, .swal2-select {
          font-size: 13px;
          height: 34px;
        }
        .swal2-label {
          font-size: 13px;
        }
        .autocomplete-item {
          font-size: 13px;
        }
        .swal2-qrcode {
          width: 120px !important;
          height: 120px !important;
        }
      }
      /* Styles for #all tab */
      #all {
        font-family: 'Prompt', sans-serif;
        background-color: #f0f4f8;
        padding: 15px;
        border-radius: 8px;
      }
      #all #searchContainerAll {
        display: flex;
        justify-content: flex-start;
        margin-bottom: 20px;
      }
      #all #searchInputAll {
        width: 100%;
        max-width: 300px;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        font-size: 16px;
      }
      #all table {
        width: 100%;
        border-collapse: collapse;
        background: #fff;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        border-radius: 12px;
        overflow: hidden;
      }
      #all th, #all td {
        padding: 6px 12px;
        text-align: left;
        border-bottom: 1px solid #e0e0e0;
        cursor: pointer;
      }
      #all th {
        background-color: #007bff;
        color: white;
      }
      #all td:nth-child(6) {
        min-width: 180px;
      }
      #all tr:hover {
        background-color: #f1f1f1;
      }
      #all .status-green {
        color: green;
        font-weight: bold;
      }
      #all .status-red {
        color: red;
        font-weight: bold;
      }
      #all .detail-button {
        padding: 6px 10px;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
      }
      #all .detail-button:hover {
        background-color: #2980b9;
      }
      #all .all-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.5);
      }
      #all .all-modal-content {
        background-color: #fff;
        margin: 10% auto;
        padding: 20px;
        border-radius: 12px;
        width: 80%;
        max-width: 500px;
      }
      #all .all-close {
        color: #aaa;
        float: right;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
      }
      #all .all-close:hover {
        color: #000;
      }
      #all #modalContentAll span.label {
        color: #007bff;
        font-weight: bold;
      }
      #all #modalContentAll span.value {
        color: #000;
      }
      #all .all-pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-top: 20px;
      }
      #all .all-pagination button,
      #all .all-pagination select {
        padding: 8px 12px;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        margin: 0 5px;
      }
      #all .all-pagination button:hover,
      #all .all-pagination select:hover {
        background-color: #2980b9;
      }
      #all .all-pagination .all-page-number {
        padding: 6px 10px;
        background-color: #ecf0f1;
        color: #3498db;
        border-radius: 6px;
        margin: 0 3px;
        cursor: pointer;
      }
      #all .all-pagination .all-page-number.active {
        background-color: #3498db;
        color: white;
      }
      #all .all-pagination img {
        width: 20px;
        height: 20px;
        cursor: pointer;
      }
      #all .all-items-per-page {
        margin-left: 10px;
        font-size: 16px;
      }
      #all .all-pagination .all-page-number {
        width: 36px;
        height: 36px;
        background-color: #3498db; /* ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô */
        color: white;
        border-radius: 50%;
        display: inline-flex;
        justify-content: center;
        align-items: center;
        margin: 0 5px;
        cursor: pointer;
        font-size: 16px;
        border: none;
        transition: background-color 0.3s; /* ‡∏•‡∏∑‡πà‡∏ô‡∏ï‡∏≠‡∏ô hover */
      }
      #all .all-pagination .all-page-number:hover {
        background-color: #2980b9; /* ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏° ‡∏ï‡∏≠‡∏ô hover */
      }
      #all .all-pagination .all-page-number.active {
        background-color: #e67e22; /* ‡∏™‡πâ‡∏°‡πÄ‡∏Ç‡πâ‡∏° ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô */
        color: white;
      }
      /* ‡πÉ‡∏™‡πà CSS ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏≠‡∏Å‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ */
      #all .all-pagination img {
        width: 20px;
        height: 20px;
        cursor: pointer;
      }
      /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á */
      #all table,
      #all th,
      #all td {
        border: 1px solid #ccc;
      }
      /* --- ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ --- */
      /* --- ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå --- */
      #all th:nth-child(3), #all td:nth-child(3) {
        width: 180px; /* Material */
        min-width: 150px;
      }
      #all th:nth-child(4), #all td:nth-child(4) {
        width: 300px; /* Description */
        min-width: 250px;
      }
      #all th:nth-child(9), #all td:nth-child(9) {
        width: 200px; /* ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ */
        min-width: 180px;
      }
      /* --- Responsive: ‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≠‡πÅ‡∏Ñ‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏î‡πâ --- */
      #all .all-table-container {
        overflow-x: auto;
        width: 100%;
      }
      #all table {
        width: 100%;
        border-collapse: collapse;
        min-width: 900px; /* ‡∏Å‡∏±‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏Ñ‡∏ö‡πÄ‡∏Å‡∏¥‡∏ô */
      }
      #all th, #all td {
        padding: 8px;
        text-align: left;
        white-space: nowrap; /* ‡∏Å‡∏±‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ï‡∏Å */
      }
      @media (max-width: 768px) {
        #all th, #all td {
          padding: 6px;
          font-size: 14px;
        }
      }
       #all tr {
          opacity: 0;
          transform: translateY(10px);
          animation: fadeInUp 0.5s ease forwards;
        }
        #all tr:nth-child(even) {
          animation-delay: 0.1s;
        }
        #all tr:nth-child(odd) {
          animation-delay: 0.2s;
        }
        @keyframes fadeInUp {
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        /* Modal Animation */
        #all .all-modal-content {
          animation: zoomIn 0.4s ease;
        }
        @keyframes zoomIn {
          from {
            opacity: 0;
            transform: scale(0.8);
          }
          to {
            opacity: 1;
            transform: scale(1);
          }
        }
        /* ‡∏õ‡∏∏‡πà‡∏° smooth */
        #all button, #all .all-page-number, #all .detail-button {
          transition: all 0.3s ease;
        }
        #all .detail-button:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        #all .all-pagination .all-page-number:hover {
          transform: scale(1.1);
        }
        #all th:nth-child(9), #all td:nth-child(9) {
          width: 80px; /* ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ ‡πÄ‡∏ä‡πà‡∏ô 60px */
          min-width: 60px;
          max-width: 100px;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }
      /* Styles for #pending-calls tab */
      #pending-calls {
        font-family: 'Prompt', sans-serif;
        background-color: #f0f4f8;
        padding: 15px;
        border-radius: 8px;
      }
      #pending-calls #searchContainerPending {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        margin-bottom: 20px;
      }
      #pending-calls .pending-filter-row {
        display: flex;
        align-items: center;
      }
      #pending-calls .pending-search-row {
        display: flex;
        align-items: center;
        margin-top: 10px;
      }
      #pending-calls #teamFilterLabelPending {
        font-size: 16px;
        color: #333;
      }
      #pending-calls #teamFilterPending {
        margin-left: 5px;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        font-size: 16px;
        background-color: #fff;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      #pending-calls #teamFilterPending:hover {
        border-color: #2980b9;
      }
      #pending-calls #searchInputPending {
        width: 300px;
        padding: 10px;
        border-radius: 8px 0 0 8px;
        border: 1px solid #ccc;
        border-right: none;
        font-size: 16px;
      }
      #pending-calls #searchButtonPending {
        padding: 10px;
        background-color: #3498db;
        color: white;
        border: 1px solid #ccc;
        border-left: none;
        border-radius: 0 8px 8px 0;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      #pending-calls #searchButtonPending:hover {
        background-color: #2980b9;
      }
      #pending-calls .pending-table-container {
        overflow-x: auto;
        width: 100%;
      }
      #pending-calls table {
        width: 100%;
        border-collapse: collapse;
        background: #fff;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        border-radius: 12px;
        overflow: hidden;
        min-width: 900px;
      }
      #pending-calls th, #pending-calls td {
        padding: 8px 12px;
        text-align: left;
        border: 1px solid #ccc;
        white-space: nowrap;
      }
      #pending-calls th {
        background-color: #007bff;
        color: white;
      }
      #pending-calls th.sortable {
        cursor: pointer;
      }
      #pending-calls th.sortable:hover {
        background-color: #0056b3;
      }
      #pending-calls .pending-arrow {
        font-size: 12px;
        margin-left: 5px;
      }
      #pending-calls tr:hover {
        background-color: #f1f1f1;
      }
      #pending-calls .pending-detail-button {
        padding: 6px 10px;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      #pending-calls .pending-detail-button:hover {
        background-color: #2980b9;
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      }
      #pending-calls .pending-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.5);
      }
      #pending-calls .pending-modal-content {
        background-color: #fff;
        margin: 10% auto;
        padding: 20px;
        border-radius: 12px;
        width: 80%;
        max-width: 500px;
        animation: zoomIn 0.4s ease;
      }
      #pending-calls .pending-close {
        color: #aaa;
        float: right;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
      }
      #pending-calls .pending-close:hover {
        color: #000;
      }
      #pending-calls #modalContentPending span.label {
        color: #007bff;
        font-weight: bold;
      }
      #pending-calls #modalContentPending span.value {
        color: #000;
      }
      #pending-calls .pending-pagination {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        margin-top: 20px;
      }
      #pending-calls .pending-pagination button,
      #pending-calls .pending-pagination select {
        padding: 8px 12px;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        margin: 0 5px;
        transition: all 0.3s ease;
      }
      #pending-calls .pending-pagination button:hover,
      #pending-calls .pending-pagination select:hover {
        background-color: #2980b9;
      }
      #pending-calls .pending-pagination .pending-page-number {
        width: 36px;
        height: 36px;
        background-color: #3498db;
        color: white;
        border-radius: 50%;
        display: inline-flex;
        justify-content: center;
        align-items: center;
        margin: 0 5px;
        cursor: pointer;
        font-size: 16px;
        border: none;
        transition: all 0.3s ease;
      }
      #pending-calls .pending-pagination .pending-page-number:hover {
        background-color: #2980b9;
        transform: scale(1.1);
      }
      #pending-calls .pending-pagination .pending-page-number.active {
        background-color: #e67e22;
        color: white;
      }
      #pending-calls .pending-items-per-page {
        margin-left: 10px;
        font-size: 16px;
      }
      #pending-calls tr {
        opacity: 0;
        transform: translateY(10px);
        animation: fadeInUp 0.5s ease forwards;
      }
      #pending-calls tr:nth-child(even) {
        animation-delay: 0.1s;
      }
      #pending-calls tr:nth-child(odd) {
        animation-delay: 0.2s;
      }
      @keyframes fadeInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      @keyframes zoomIn {
        from {
          opacity: 0;
          transform: scale(0.8);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      #pending-calls th:nth-child(3), #pending-calls td:nth-child(3) {
        width: auto;
        min-width: 80px;
        max-width: 150px;
        white-space: normal;
      }
      #pending-calls th:nth-child(5), #pending-calls td:nth-child(5) {
        width: 150px;
        min-width: 120px;
      }
      #pending-calls td:nth-child(7), #pending-calls th:nth-child(7) {
        min-width: 200px;
      }
      @media (max-width: 768px) {
        #pending-calls th:nth-child(3), #pending-calls td:nth-child(3) {
          min-width: 60px;
          font-size: 14px;
        }
      }
      #pending-calls .pending-highlight-red {
        color: red;
        font-weight: bold;
      }
      #pending-calls .pending-yellow-light {
        background-color: #c9ffc4;
      }
      #pending-calls .pending-pink-pastel {
        background-color: #fce4ec;
      }
      #pending-calls .pending-text-left {
        text-align: left;
      }
      #pending-calls .pending-text-center {
        text-align: center;
      }
      #pending-calls .pending-call-count-box {
        margin-left: 20px;
        padding: 10px 16px;
        background-color: #e6f2ff;
        color: #007bff;
        border: 1px solid #d0eaff;
        border-radius: 10px;
        font-size: 16px;
        font-weight: bold;
        display: inline-flex;
        align-items: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        transition: background-color 0.3s ease;
      }
      #pending-calls .pending-call-count-box span {
        color: #d63384;
        margin: 0 4px;
        font-size: 18px;
      }
      #pending-calls .pending-modern-label {
        display: inline-block;
        padding: 10px 16px;
        background-color: #ffffff;
        color: #007bff;
        border-radius: 10px;
        font-size: 16px;
        font-weight: bold;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        border: 1px solid #d0eaff;
        transition: all 0.3s ease;
        margin-right: 8px;
      }
      #pending-calls .pending-modern-label:hover {
        background-color: #e6f2ff;
        color: #0056b3;
      }
      /* Disclaimer banner for legitimacy */
      .disclaimer {
        background-color: #fff3cd;
        border: 1px solid #ffeaa7;
        color: #856404;
        padding: 10px;
        margin-bottom: 15px;
        border-radius: 8px;
        text-align: center;
        font-size: 14px;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£</h1>
    </div>
    <div class="loading" id="loading">
      <span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</span>
    </div>
    <div class="container">
      <!-- Added disclaimer to clarify this is an internal tool -->
      <div class="disclaimer">
        ‚ö†Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Forms ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ | ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢ ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ ‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ 62 
      </div>
      <div class="tabs">
        <button class="tab-button active" id="tab-parts" onclick="showTab('parts')">
          ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å
        </button>
        <button class="tab-button" id="tab-today" onclick="showTab('today')">
          ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
        </button>
        <button class="tab-button" id="tab-all" onclick="showTab('all')">
          ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà
        </button>
        <button class="tab-button" id="tab-pending-calls" onclick="showTab('pending-calls')">
          ‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏à‡πà‡∏≤‡∏¢‡∏ï‡∏≤‡∏° Call
        </button>
      </div>
      <div id="parts" class="tab-content active">
        <div id="searchContainer">
          <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ Code, Description...." />
          <button id="searchButton" class="refresh-button">
            <i class="fas fa-search"></i>
          </button>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <div id="error-container">
          <p id="error-message">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</p>
          <button id="retry-button">‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button>
        </div>
        <div class="table-container">
          <table id="data-table">
            <thead>
              <tr>
                <th>‡πÄ‡∏ö‡∏¥‡∏Å</th>
                <th>Image</th>
                <th>Material</th>
                <th>Description</th>
                <th>‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ</th>
                <th>‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£</th>
                <th>Rebuilt</th>
                <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                <th>Product</th>
                <th>Spec</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div id="pagination" class="pagination">
          <button id="firstPage">
            <i class="fas fa-chevron-left"></i><i class="fas fa-chevron-left"></i>
          </button>
          <button id="prevPage"><i class="fas fa-chevron-left"></i></button>
          <div id="pageNumbers"></div>
          <button id="nextPage"><i class="fas fa-chevron-right"></i></button>
          <button id="lastPage">
            <i class="fas fa-chevron-right"></i><i class="fas fa-chevron-right"></i>
          </button>
          <div class="items-per-page">
            <label for="itemsPerPage">Show</label>
            <select id="itemsPerPage">
              <option value="10">10</option>
              <option value="20">20</option>
              <option value="30">30</option>
            </select>
          </div>
        </div>
      </div>
      <div id="today" class="tab-content">
        <div id="searchContainer">
          <input type="text" id="searchInputToday" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ Code, Material, ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ó‡∏µ‡∏°..." />
        </div>
        <div id="error-container-today" class="error-container" style="display: none;">
          <p id="error-message-today">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</p>
          <button id="retry-button-today">‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button>
        </div>
        <div id="loadingToday" class="spinner-container">
          <div class="spinner"></div>
          <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
        </div>
        <div class="table-container">
          <table id="data-table-today">
            <thead>
              <tr>
                <th>Status</th>
                <th>‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</th>
                <th>Material</th>
                <th>Description</th>
                <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                <th>‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ</th>
                <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á</th>
                <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
                <th>Call</th>
                <th>CallType</th>
                <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                <th>‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div id="detailModal" class="modal">
          <div class="modal-content">
            <span class="close" id="closeModal">√ó</span>
            <h2>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</h2>
            <div id="modalContent"></div>
          </div>
        </div>
      </div>
      <div id="all" class="tab-content">
        <div id="searchContainerAll">
          <input type="text" id="searchInputAll" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ Code,Description, ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ó‡∏µ‡∏°..." />
        </div>
        <div class="all-table-container">
          <table id="data-table-all">
            <thead>
              <tr>
                <th>Status</th>
                <th class="sortable" data-column="Timestamp">‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ <span class="arrow"></span></th>
                <th class="sortable" data-column="Code">Material <span class="arrow"></span></th>
                <th class="sortable" data-column="Material Description">Description <span class="arrow"></span></th>
                <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                <th class="sortable" data-column="‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á">‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á <span class="arrow"></span></th>
                <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
                <th>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πàCall</th>
                <th>CallType</th>
                <th class="sortable" data-column="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ <span class="arrow"></span></th>
                <th>‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div id="detailModalAll" class="all-modal">
          <div class="all-modal-content">
            <span class="all-close" id="closeModalAll">&times;</span>
            <h2>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</h2>
            <div id="modalContentAll"></div>
          </div>
        </div>
        <div class="all-pagination">
          <button id="firstPageAll"><i class="fas fa-chevron-left"></i><i class="fas fa-chevron-left"></i></button>
          <button id="prevPageAll"><i class="fas fa-chevron-left"></i></button>
          <div id="pageNumbersAll"></div>
          <button id="nextPageAll"><i class="fas fa-chevron-right"></i></button>
          <button id="lastPageAll">
            <i class="fas fa-chevron-right"></i><i class="fas fa-chevron-right"></i>
          </button>
          <div class="all-items-per-page">
            <label for="itemsPerPageAll">:</label>
            <select id="itemsPerPageAll">
              <option value="10">10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</option>
              <option value="20">20 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</option>
              <option value="30">30 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</option>
            </select>
          </div>
        </div>
      </div>
      <div id="pending-calls" class="tab-content">
        <div id="searchContainerPending">
          <div class="pending-filter-row">
            <label id="teamFilterLabelPending" for="teamFilterPending" class="pending-modern-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°</label>
            <select id="teamFilterPending">
              <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
            </select>
            <div id="callCountInfoPending" class="pending-call-count-box">
              ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Ticket ‡∏Ñ‡πâ‡∏≤‡∏á <span id="callCountValuePending">0</span> Call
            </div>
          </div>
          <div class="pending-search-row">
            <input type="text" id="searchInputPending" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ Ticket, Team, ‡∏™‡∏≤‡∏Ç‡∏≤, ‡∏Ñ‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô, Material, Description..." />
            <button id="searchButtonPending"><i class="fas fa-search"></i></button>
          </div>
        </div>
        <div class="pending-table-container">
          <table id="data-table-pending">
            <thead>
              <tr>
                <th class="sortable" data-column="DateTime">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á <span class="pending-arrow"></span></th>
                <th class="sortable" data-column="Ticket Number">Ticket <span class="pending-arrow"></span></th>
                <th class="sortable" data-column="Team">Team <span class="pending-arrow"></span></th>
                <th class="sortable" data-column="Brand">‡∏™‡∏≤‡∏Ç‡∏≤ <span class="pending-arrow"></span></th>
                <th class="sortable" data-column="‡∏Ñ‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô">‡∏Ñ‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô <span class="pending-arrow"></span></th>
                <th class="sortable" data-column="Material">Material <span class="pending-arrow"></span></th>
                <th class="sortable" data-column="Description">Description <span class="pending-arrow"></span></th>
                <th class="sortable" data-column="Vipa">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ <span class="pending-arrow"></span></th>
                <th class="sortable" data-column="DayRepair">‡∏Ñ‡πâ‡∏≤‡∏á(‡∏ß‡∏±‡∏ô) <span class="pending-arrow"></span></th>
                <th>‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div id="detailModalPending" class="pending-modal">
          <div class="pending-modal-content">
            <span class="pending-close" id="closeModalPending">√ó</span>
            <h2>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</h2>
            <div id="modalContentPending"></div>
          </div>
        </div>
        <div class="pending-pagination">
          <button id="firstPagePending"><i class="fas fa-chevron-left"></i><i class="fas fa-chevron-left"></i></button>
          <button id="prevPagePending"><i class="fas fa-chevron-left"></i></button>
          <div id="pageNumbersPending"></div>
          <button id="nextPagePending"><i class="fas fa-chevron-right"></i></button>
          <button id="lastPagePending">
            <i class="fas fa-chevron-right"></i><i class="fas fa-chevron-right"></i>
          </button>
          <div class="pending-items-per-page">
            <label for="itemsPerPagePending">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤:</label>
            <select id="itemsPerPagePending">
              <option value="10">10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</option>
              <option value="20" selected>20 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</option>
              <option value="30">30 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    <div class="footer">
      <p>¬© 2025 ‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ SparePart ‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ 62 | ‡∏™‡∏á‡∏ß‡∏ô‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</p>
    </div>
   <div class="social-buttons">
  <button class="social-button qrcode" onclick="showQRCode()">
    <i class="fas fa-qrcode"></i>
  </button>
</div>
    <script>
      function showTab(tabId) {
        const buttons = document.querySelectorAll(".tab-button");
        const contents = document.querySelectorAll(".tab-content");
        document.getElementById("loading").style.display = "flex";
        buttons.forEach((btn) => btn.classList.remove("active"));
        contents.forEach((tab) => tab.classList.remove("active"));
        const targetTab = document.getElementById(tabId);
        targetTab.classList.add("active");
        const clickedButton = Array.from(buttons).find(
          (btn) => btn.id === `tab-${tabId}`
        );
        if (clickedButton) clickedButton.classList.add("active");
        if (tabId === "parts") {
          loadData();
        } else if (tabId === "today") {
          loadTodayData();
        } else if (tabId === "all") {
          loadAllData();
        } else if (tabId === "pending-calls") {
          loadPendingCallsData();
        }
        hideLoading();
      }
      function hideLoading() {
        document.getElementById("loading").style.display = "none";
      }
      function showQRCode() {
        Swal.fire({
          title: 'üì∑ ‡∏™‡πÅ‡∏Å‡∏ô QR Code',
          html: `
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://request888.vercel.app/" alt="QR Code" class="swal2-qrcode" style="width: 150px; height: 150px;">
            <p>‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà</p>
          `,
          confirmButtonText: '‡∏õ‡∏¥‡∏î',
          customClass: {
            popup: 'swal2-popup',
            title: 'swal2-title',
            confirmButton: 'swal2-confirm'
          }
        });
      }
      // Parts tab script (original)
      const sheetID = "1nbhLKxs7NldWo_y0s4qZ8rlpIfyyGkR_Dqq8INmhYlw";
      const sheetName = "MainSap";
      const url = `https://opensheet.elk.sh/${sheetID}/${sheetName}`;
      const searchInput = document.getElementById("searchInput");
      const searchButton = document.getElementById("searchButton");
      const tableBody = document.querySelector("#data-table tbody");
      const pagination = document.getElementById("pagination");
      const pageNumbers = document.getElementById("pageNumbers");
      const itemsPerPageSelect = document.getElementById("itemsPerPage");
      const firstPageButton = document.getElementById("firstPage");
      const prevPageButton = document.getElementById("prevPage");
      const nextPageButton = document.getElementById("nextPage");
      const lastPageButton = document.getElementById("lastPage");
      const errorContainer = document.getElementById("error-container");
      const retryButton = document.getElementById("retry-button");
      let allData = [];
      let currentPage = 1;
      let itemsPerPage = 10;
      let currentFilteredData = [];
      itemsPerPageSelect.addEventListener("change", () => {
        itemsPerPage = parseInt(itemsPerPageSelect.value, 10);
        currentPage = 1;
        renderTableData();
        renderPagination(allData.length);
      });
      retryButton.addEventListener("click", () => {
        errorContainer.style.display = "none";
        loadData();
      });
      function renderTable(data) {
        if (!tableBody) {
          console.error("Table body for #data-table not found");
          Swal.fire({
            icon: "error",
            title: "‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î",
            text: "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö",
            confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
          });
          return;
        }
        tableBody.innerHTML = "";
        data.forEach((row) => {
          const tr = document.createElement("tr");
          const requisitionTd = document.createElement("td");
          const btn = document.createElement("button");
          btn.textContent = "‡πÄ‡∏ö‡∏¥‡∏Å";
          btn.className = "requisition-button";
          btn.onclick = () => showRequisitionDialog(row);
          requisitionTd.appendChild(btn);
          tr.appendChild(requisitionTd);
          const columns = [
            "UrlWeb",
            "Material",
            "Description",
            "‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ",
            "Unrestricted",
            "Rebuilt",
            "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏",
            "Product",
            "OCRTAXT"
          ];
          // Convert values to numbers for comparison
          const vibhavadiValue = parseFloat(row["‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ"]) || 0;
          const unrestrictedValue = parseFloat(row["Unrestricted"]) || 0;
          // Determine styling based on conditions
          let textColor = "";
          let fontWeight = "";
          if (vibhavadiValue > 0) {
            textColor = "#4caf50"; // Green
            fontWeight = "bold";
          } else if (vibhavadiValue === 0 && unrestrictedValue > 0) {
            textColor = "#2196f3"; // Blue
            fontWeight = "bold";
          }
          columns.forEach((col) => {
            const td = document.createElement("td");
            let value = row[col] || "";
            if (col === "‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ" || col === "Unrestricted") {
              if (value && !isNaN(value)) {
                value = Number(value).toLocaleString("en-US", {
                  maximumFractionDigits: 0,
                });
              } else if (value === "0" || value === 0) {
                value = "";
              }
            }
            if ((col === "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏" || col === "Rebuilt") && value) {
              td.style.color = "red";
              td.style.fontWeight = "bold";
            }
            // Apply conditional styling to Material, Description, ‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ, and Unrestricted
            if (
              col === "Material" ||
              col === "Description" ||
              col === "‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ" ||
              col === "Unrestricted"
            ) {
              if (textColor) td.style.color = textColor;
              if (fontWeight) td.style.fontWeight = fontWeight;
            }
            if (col === "UrlWeb" && value && value.startsWith("https://drive.google.com/uc?")) {
              td.innerHTML = `
                <a href="${value}" target="_blank" rel="noopener noreferrer">
                 <button class="view-image-btn">‡∏î‡∏π‡∏£‡∏π‡∏õ</button>
                </a>
              `;
            } else if (col === "UrlWeb" && value) {
              td.innerHTML = `
                <a href="${value}" target="_blank" rel="noopener noreferrer">
                  <button class="view-image-btn">‡∏î‡∏π‡∏£‡∏π‡∏õ</button>
                </a>
              `;
            } else {
              td.textContent = value;
            }
            tr.appendChild(td);
          });
          tableBody.appendChild(tr);
        });
      }
      async function loadEmployeeData() {
        const employeeSheetID = "1eqVoLsZxGguEbRCC5rdI4iMVtQ7CK4T3uXRdx8zE3uw";
        const employeeSheetName = "Employee";
        const employeeUrl = `https://opensheet.elk.sh/${employeeSheetID}/${employeeSheetName}`;
        try {
          const response = await fetch(employeeUrl);
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const data = await response.json();
          return data;
        } catch (error) {
          console.error("Error loading employee data:", error);
          return [];
        }
      }
      async function showRequisitionDialog(row) {
        document.body.style.overflow = 'hidden';
        const history = {
          employeeCode: getFromLocalStorage('employeeCode'),
          team: getFromLocalStorage('team'),
          contact: getFromLocalStorage('contact'),
          callNumber: getFromLocalStorage('callNumber'),
          callType: getFromLocalStorage('callType'),
        };
        const employeeData = await loadEmployeeData();
        Swal.fire({
          title: 'üìã ‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£',
          html: `
            <style>
              .autocomplete-items {
                position: absolute;
                border: 1px solid #ccc;
                border-top: none;
                z-index: 9999;
                background-color: white;
                width: 100%;
                max-height: 120px;
                overflow-y: auto;
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                margin-top: 2px;
                border-radius: 6px;
              }
              .autocomplete-item {
                padding: 6px;
                cursor: pointer;
                font-size: 14px;
              }
              .autocomplete-item:hover {
                background-color: #f1f1f1;
              }
              .swal2-label {
                text-align: left !important;
                display: block !important;
                margin: 8px 0 4px !important;
                font-weight: bold !important;
                width: 100% !important;
              }
              .swal2-input, .swal2-select {
                width: 100% !important;
                margin: 4px 0 !important;
                padding: 6px !important;
                box-sizing: border-box !important;
                font-size: 14px !important;
                height: 36px !important;
              }
              .error-message {
                color: red !important;
                font-size: 12px !important;
                margin-top: 2px !important;
                display: block !important;
                text-align: left !important;
              }
              .invalid-input {
                border: 2px solid red !important;
                box-shadow: 0 0 5px rgba(255, 0, 0, 0.5) !important;
              }
              #swal-employee-name-display, #swal-team-display {
                color: #4caf50 !important;
                font-weight: bold !important;
                margin: 4px 0 !important;
                padding: 4px !important;
                background: #e8f5e8 !important;
                border-radius: 4px !important;
                text-align: left !important;
              }
            </style>
            <div class="swal2-label">üì¶ Material: ${row.Material || ''}</div>
            <div class="swal2-label">üìù Description: ${row.Description || ''}</div>
            <label class="swal2-label">üî¢ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
            <input id="swal-quantity" class="swal2-input" type="number" value="1" min="1">
            <span id="swal-quantity-error" class="error-message"></span>
            <label class="swal2-label">üÜî ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
            <input id="swal-employee-code" class="swal2-input" placeholder="7xxxxxx">
            <div id="employee-code-history" class="autocomplete-items" style="display:none;"></div>
            <span id="swal-employee-code-error" class="error-message"></span>
            <label class="swal2-label">üë§ ‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
            <div id="swal-employee-name-display"></div>
            <label class="swal2-label">üë• ‡∏ó‡∏µ‡∏°</label>
            <div id="swal-team-display"></div>
            <label class="swal2-label">üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
            <input id="swal-contact" class="swal2-input" placeholder="‡πÄ‡∏ä‡πà‡∏ô 08xxxxxxxx">
            <div id="contact-history" class="autocomplete-items" style="display:none;"></div>
            <span id="swal-contact-error" class="error-message"></span>
            <label class="swal2-label">üìÑ ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà Call</label>
            <input id="swal-call-number" class="swal2-input" placeholder="2... ‡∏´‡∏£‡∏∑‡∏≠ ...">
            <div id="call-number-history" class="autocomplete-items" style="display:none;"></div>
            <span id="swal-call-number-error" class="error-message"></span>
            <label class="swal2-label">üó≥Ô∏è Call Type</label>
            <select id="swal-call-type" class="swal2-select">
              <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Call Type</option>
              <option value="I">I</option>
              <option value="P">P</option>
              <option value="Q">Q</option>
              <option value="R">R</option>
            </select>
            <span id="swal-call-type-error" class="error-message"></span>
            <label class="swal2-label">üóíÔ∏è ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
            <input id="swal-remark" class="swal2-input" placeholder="‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö" readonly>
            <span id="swal-remark-error" class="error-message"></span>
          `,
          focusConfirm: false,
          showCancelButton: true,
          confirmButtonText: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',
          cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
          allowOutsideClick: false,
          allowEscapeKey: false,
          didOpen: () => {
            const quantityInput = document.getElementById('swal-quantity');
            const employeeCodeInput = document.getElementById('swal-employee-code');
            const contactInput = document.getElementById('swal-contact');
            const callNumberInput = document.getElementById('swal-call-number');
            const callTypeInput = document.getElementById('swal-call-type');
            const remarkInput = document.getElementById('swal-remark');
            const confirmButton = document.querySelector('.swal2-confirm');
            confirmButton.disabled = true;
            function setupAutocomplete(input, key, containerId) {
              input.addEventListener('input', () => {
                const container = document.getElementById(containerId);
                const val = input.value.toLowerCase();
                const items = getFromLocalStorage(key).filter(item => item.toLowerCase().includes(val));
                container.innerHTML = '';
                items.forEach(item => {
                  const div = document.createElement('div');
                  div.className = 'autocomplete-item';
                  div.textContent = item;
                  div.onclick = () => {
                    input.value = item;
                    container.style.display = 'none';
                    validateInputs();
                  };
                  container.appendChild(div);
                });
                container.style.display = items.length ? 'block' : 'none';
              });
              input.addEventListener('blur', () => {
                setTimeout(() => {
                  const container = document.getElementById(containerId);
                  container.style.display = 'none';
                }, 200);
              });
            }
            setupAutocomplete(contactInput, 'contact', 'contact-history');
            setupAutocomplete(callNumberInput, 'callNumber', 'call-number-history');
            setupAutocomplete(callTypeInput, 'callType', 'call-type-history');
            const lastContact = getFromLocalStorage('contact')[0];
            if (lastContact) contactInput.value = lastContact;
            const inputs = [quantityInput, employeeCodeInput, contactInput, callNumberInput, callTypeInput, remarkInput];
            inputs.forEach(input => {
              input.addEventListener('focus', () => {
                const popup = document.querySelector('.swal2-popup');
                popup.style.transform = 'translateY(-20%)';
                popup.style.transition = 'transform 0.3s ease';
              });
              input.addEventListener('blur', () => {
                const popup = document.querySelector('.swal2-popup');
                popup.style.transform = 'translateY(0)';
              });
            });
            function validateInputs() {
              const errors = {
                quantityError: document.getElementById('swal-quantity-error'),
                employeeCodeError: document.getElementById('swal-employee-code-error'),
                contactError: document.getElementById('swal-contact-error'),
                callNumberError: document.getElementById('swal-call-number-error'),
                callTypeError: document.getElementById('swal-call-type-error'),
                remarkError: document.getElementById('swal-remark-error')
              };
              inputs.forEach(input => input.classList.remove('invalid-input'));
              Object.values(errors).forEach(el => el.textContent = '');
              let isValid = true;
              if (!quantityInput.value || quantityInput.value < 1) {
                errors.quantityError.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 1';
                quantityInput.classList.add('invalid-input');
                isValid = false;
              }
              const employeeCode = employeeCodeInput.value.trim();
              if (!employeeCode || !/^\d{7}$/.test(employeeCode) || employeeCode[0] !== '7') {
                errors.employeeCodeError.textContent = '‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 7 ‡∏´‡∏•‡∏±‡∏Å ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢ 7 (‡πÄ‡∏ä‡πà‡∏ô 7512411)';
                employeeCodeInput.classList.add('invalid-input');
                document.getElementById('swal-employee-name-display').textContent = '';
                document.getElementById('swal-team-display').textContent = '';
                isValid = false;
              } else {
                // Check against employee data
                const employee = employeeData.find(e => e.IDRec && e.IDRec.toString().trim() === employeeCode);
                if (!employee || !employee.Name) {
                  errors.employeeCodeError.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö';
                  employeeCodeInput.classList.add('invalid-input');
                  document.getElementById('swal-employee-name-display').textContent = '';
                  document.getElementById('swal-team-display').textContent = '';
                  isValid = false;
                } else {
                  document.getElementById('swal-employee-name-display').textContent = `${employee.Name}`;
                  document.getElementById('swal-team-display').textContent = `${employee.‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô || ''}`;
                  errors.employeeCodeError.textContent = '';
                }
              }
              if (!contactInput.value || !/^(0|\+66)[6-9][0-9]{7,8}$/.test(contactInput.value)) {
                errors.contactError.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÄ‡∏ä‡πà‡∏ô 08xxxxxxxx)';
                contactInput.classList.add('invalid-input');
                isValid = false;
              }
              const hasRemark = remarkInput.value.trim().length > 0;
              if (!hasRemark) {
                if (!callNumberInput.value) {
                  errors.callNumberError.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà Call';
                  callNumberInput.classList.add('invalid-input');
                  isValid = false;
                } else if (
                  (callNumberInput.value.startsWith('2') && callNumberInput.value.length !== 11) ||
                  (!callNumberInput.value.startsWith('2') && callNumberInput.value.length !== 7)
                ) {
                  errors.callNumberError.textContent = '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà Call ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ 2 (11 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£) ‡∏´‡∏£‡∏∑‡∏≠ (7 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)';
                  callNumberInput.classList.add('invalid-input');
                  isValid = false;
                }
                if (!callTypeInput.value) {
                  errors.callTypeError.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Call Type';
                  callTypeInput.classList.add('invalid-input');
                  isValid = false;
                }
              }
              confirmButton.disabled = !isValid;
            }
            quantityInput.addEventListener('input', validateInputs);
            employeeCodeInput.addEventListener('input', validateInputs);
            contactInput.addEventListener('input', validateInputs);
            callNumberInput.addEventListener('input', validateInputs);
            callTypeInput.addEventListener('change', validateInputs);
            remarkInput.addEventListener('input', validateInputs);
            validateInputs();
            quantityInput.focus();
          },
          didClose: () => {
            document.body.style.overflow = 'auto';
          },
          preConfirm: () => {
            const quantityInput = document.getElementById('swal-quantity');
            const employeeCodeInput = document.getElementById('swal-employee-code');
            const contactInput = document.getElementById('swal-contact');
            const callNumberInput = document.getElementById('swal-call-number');
            const callTypeInput = document.getElementById('swal-call-type');
            const remarkInput = document.getElementById('swal-remark');
            const errors = {
              quantityError: document.getElementById('swal-quantity-error'),
              employeeCodeError: document.getElementById('swal-employee-code-error'),
              contactError: document.getElementById('swal-contact-error'),
              callNumberError: document.getElementById('swal-call-number-error'),
              callTypeError: document.getElementById('swal-call-type-error'),
              remarkError: document.getElementById('swal-remark-error')
            };
            [quantityInput, employeeCodeInput, contactInput, callNumberInput, callTypeInput, remarkInput].forEach(input => {
              input.classList.remove('invalid-input');
            });
            Object.values(errors).forEach(el => el.textContent = '');
            let isValid = true;
            if (!quantityInput.value || quantityInput.value < 1) {
              errors.quantityError.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 1';
              quantityInput.classList.add('invalid-input');
              isValid = false;
            }
            const employeeCode = employeeCodeInput.value.trim();
            console.log('Employee Code Input:', employeeCode);
            if (!employeeCode || !/^\d{7}$/.test(employeeCode) || employeeCode[0] !== '7') {
              errors.employeeCodeError.textContent = '‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 7 ‡∏´‡∏•‡∏±‡∏Å ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢ 7 (‡πÄ‡∏ä‡πà‡∏ô 7512411)';
              employeeCodeInput.classList.add('invalid-input');
              isValid = false;
            } else {
              const employee = employeeData.find(e => e.IDRec && e.IDRec.toString().trim() === employeeCode);
              if (!employee || !employee.Name) {
                errors.employeeCodeError.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö';
                employeeCodeInput.classList.add('invalid-input');
                isValid = false;
              }
            }
            if (!contactInput.value || !/^(0|\+66)[6-9][0-9]{7,8}$/.test(contactInput.value)) {
              errors.contactError.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÄ‡∏ä‡πà‡∏ô 08xxxxxxxx)';
              contactInput.classList.add('invalid-input');
              isValid = false;
            }
            const hasRemark = remarkInput.value.trim().length > 0;
            if (!hasRemark) {
              if (!callNumberInput.value) {
                errors.callNumberError.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà Call';
                callNumberInput.classList.add('invalid-input');
                isValid = false;
              } else if (
                (callNumberInput.value.startsWith('2') && callNumberInput.value.length !== 11) ||
                (!callNumberInput.value.startsWith('2') && callNumberInput.value.length !== 7)
              ) {
                errors.callNumberError.textContent = '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà Call ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ 2 (11 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£) ‡∏´‡∏£‡∏∑‡∏≠ (7 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)';
                callNumberInput.classList.add('invalid-input');
                isValid = false;
              }
              if (!callTypeInput.value) {
                errors.callTypeError.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Call Type';
                callTypeInput.classList.add('invalid-input');
                isValid = false;
              }
            }
            if (isValid) {
              const employee = employeeData.find(e => e.IDRec && e.IDRec.toString().trim() === employeeCode);
              saveToLocalStorage('employeeCode', employeeCode);
              saveToLocalStorage('contact', contactInput.value);
              if (callNumberInput.value) {
                saveToLocalStorage('callNumber', callNumberInput.value);
              }
              if (callTypeInput.value) {
                saveToLocalStorage('callType', callTypeInput.value);
              }
              return {
                quantity: quantityInput.value,
                employeeCode: employeeCode,
                employeeName: employee ? employee.Name : '',
                team: employee ? (employee.‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô || '') : '',
                contact: contactInput.value,
                callNumber: callNumberInput.value,
                callType: callTypeInput.value,
                remark: remarkInput.value
              };
            }
            return false;
          }
        }).then(async (result) => {
          if (result.isConfirmed) {
            const formValues = result.value;
            const vibhavadiValue = parseFloat(row["‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ"]) || 0;
            const quantity = parseFloat(formValues.quantity) || 0;
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            if (quantity <= vibhavadiValue) {
              await Swal.fire({
                icon: 'warning',
                title: '‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô',
                text: `‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏±‡∏á‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà ${vibhavadiValue.toLocaleString()} ‡∏ä‡∏¥‡πâ‡∏ô (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å ${quantity} ‡∏ä‡∏¥‡πâ‡∏ô)`,
                confirmButtonText: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠',
                allowOutsideClick: false,
                allowEscapeKey: false
              });
            }
            // ‡πÄ‡∏û‡∏¥‡πà‡∏° popup ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
            const summaryResult = await Swal.fire({
              title: '‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å',
              html: `
                <div style="text-align: left; font-size: 14px;">
                  <p><strong>Material:</strong> ${row.Material || ''}</p>
                  <p><strong>Description:</strong> ${row.Description || ''}</p>
                  <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</strong> ${formValues.quantity}</p>
                  <p><strong>‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:</strong> ${formValues.employeeCode}</p>
                  <p><strong>‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:</strong> ${formValues.employeeName}</p>
                  <p><strong>‡∏ó‡∏µ‡∏°:</strong> ${formValues.team}</p>
                  <p><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠:</strong> ${formValues.contact}</p>
                  <p><strong>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà Call:</strong> ${formValues.callNumber || '‡πÑ‡∏°‡πà‡∏°‡∏µ'}</p>
                  <p><strong>Call Type:</strong> ${formValues.callType || '‡πÑ‡∏°‡πà‡∏°‡∏µ'}</p>
                  <p><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ${formValues.remark || '‡πÑ‡∏°‡πà‡∏°‡∏µ'}</p>
                  <hr style="margin: 10px 0;">
                </div>
              `,
              icon: 'info',
              showCancelButton: true,
              confirmButtonText: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å',
              cancelButtonText: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç',
              allowOutsideClick: false,
              allowEscapeKey: false
            });
            if (summaryResult.isConfirmed) {
              // ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
              const formUrl = "https://docs.google.com/forms/d/e/1FAIpQLScEkPW7y1aM-Zb4YmvL_ytjgSssPZMpiEjOSspQZd_vzo7bRA/formResponse";
              const formData = new URLSearchParams();
              formData.append("entry.1920472981", row.Material);
              formData.append("entry.1467523821", row.Description);
              formData.append("entry.795690319", formValues.quantity);
              formData.append("entry.794964518", formValues.contact);
              formData.append("entry.702998988", formValues.employeeCode);
              formData.append("entry.1899594146", formValues.team);
              formData.append("entry.1607225659", formValues.callNumber);
              formData.append("entry.738519154", formValues.callType);
              Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
                html: `
                  <div class="swal2-spinner-container">
                    <div class="swal2-spinner"></div>
                    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>
                  </div>
                `,
                showConfirmButton: false,
                allowOutsideClick: false,
                allowEscapeKey: false
              });
              try {
                const response = await fetch(formUrl, {
                  method: "POST",
                  mode: "no-cors",
                  headers: {
                    "Content-Type": "application/x-www-form-urlencoded"
                  },
                  body: formData.toString()
                });
                await new Promise(resolve => setTimeout(resolve, 2000));
                Swal.fire({
                  icon: 'success',
                  title: '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                  text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                  confirmButtonText: 'OK'
                }).then((result) => {
                  if (result.isConfirmed) {
                    Swal.fire({
                      title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤...',
                      html: `
                        <div class="swal2-spinner-container">
                          <div class="swal2-spinner"></div>
                          <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>
                        </div>
                      `,
                      showConfirmButton: false,
                      allowOutsideClick: false,
                      allowEscapeKey: false
                    });
                    setTimeout(() => {
                      Swal.close();
                      showTab('today');
                    }, 2000);
                  }
                });
              } catch (error) {
                console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°:', error);
                Swal.fire({
                  icon: 'error',
                  title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                  text: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Form ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà',
                  confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á'
                });
              }
            }
          }
        });
      }
      function saveToLocalStorage(key, value) {
        let items = JSON.parse(localStorage.getItem(key)) || [];
        if (!items.includes(value)) {
          items.unshift(value);
          if (items.length > 5) items.pop();
          localStorage.setItem(key, JSON.stringify(items));
        }
      }
      function getFromLocalStorage(key) {
        return JSON.parse(localStorage.getItem(key)) || [];
      }
      function renderPagination(totalItems) {
        const totalPages = Math.ceil(totalItems / itemsPerPage);
        pageNumbers.innerHTML = "";
        let startPage = Math.max(1, currentPage - 2);
        let endPage = Math.min(totalPages, currentPage + 2);
        if (totalPages <= 5) {
          startPage = 1;
          endPage = totalPages;
        } else {
          if (currentPage <= 3) {
            endPage = 5;
          } else if (currentPage >= totalPages - 2) {
            startPage = totalPages - 4;
          }
        }
        for (let page = startPage; page <= endPage; page++) {
          const button = document.createElement("button");
          button.textContent = page;
          button.className = page === currentPage ? "active" : "";
          button.onclick = () => changePage(page);
          pageNumbers.appendChild(button);
        }
        firstPageButton.disabled = currentPage === 1;
        prevPageButton.disabled = currentPage === 1;
        nextPageButton.disabled = currentPage === totalPages;
        lastPageButton.disabled = currentPage === totalPages;
      }
      function changePage(page) {
        currentPage = page;
        renderTableData();
        renderPagination(currentFilteredData.length);
      }
      function renderTableData() {
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        renderTable(currentFilteredData.slice(startIndex, endIndex));
      }
      searchButton.addEventListener("click", () => {
        const keyword = searchInput.value.trim().toLowerCase();
        if (!keyword) {
          Swal.fire({
            icon: "warning",
            title: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤",
            text: "‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤!",
            confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
          });
          currentFilteredData = allData;
        } else {
          currentFilteredData = allData.filter((row) => {
            return (
              (row["Material"] || "").toLowerCase().includes(keyword) ||
              (row["Description"] || "").toLowerCase().includes(keyword) ||
              (row["Rebuilt"] || "").toLowerCase().includes(keyword) ||
              (row["Product"] || "").toLowerCase().includes(keyword) ||
              (row["OCRTAXT"] || "").toLowerCase().includes(keyword) ||
              (row["‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"] || "").toLowerCase().includes(keyword)
            );
          });
        }
        currentPage = 1;
        renderTableData();
        renderPagination(currentFilteredData.length);
      });
      searchInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          searchButton.click();
          searchInput.blur();
        }
      });
      firstPageButton.addEventListener("click", () => {
        currentPage = 1;
        renderTableData();
        renderPagination(currentFilteredData.length);
      });
      prevPageButton.addEventListener("click", () => {
        if (currentPage > 1) {
          currentPage--;
          renderTableData();
          renderPagination(currentFilteredData.length);
        }
      });
      nextPageButton.addEventListener("click", () => {
        const totalPages = Math.ceil(currentFilteredData.length / itemsPerPage);
        if (currentPage < totalPages) {
          currentPage++;
          renderTableData();
          renderPagination(currentFilteredData.length);
        }
      });
      lastPageButton.addEventListener("click", () => {
        const totalPages = Math.ceil(currentFilteredData.length / itemsPerPage);
        currentPage = totalPages;
        renderTableData();
        renderPagination(currentFilteredData.length);
      });
      async function loadData() {
        document.getElementById("loading").style.display = "flex";
        errorContainer.style.display = "none";
        console.log("Starting data load from:", url);
        try {
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 15000);
          const response = await fetch(url, { signal: controller.signal });
          clearTimeout(timeoutId);
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const data = await response.json();
          console.log("Data loaded successfully:", data);
          if (!Array.isArray(data) || data.length === 0) {
            throw new Error("No data received or data is empty");
          }
          allData = data;
          currentFilteredData = data;
          renderTableData();
          renderPagination(data.length);
          document.getElementById("loading").style.display = "none";
        } catch (error) {
          console.error("Error loading data:", error);
          document.getElementById("loading").style.display = "none";
          errorContainer.style.display = "block";
          document.getElementById("error-message").textContent = error.message.includes("aborted")
            ? "‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠"
            : `‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ${error.message}`;
          Swal.fire({
            icon: "error",
            title: "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
            text: error.message.includes("aborted")
              ? "‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ä‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà"
              : "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Sheet ID, ‡∏ä‡∏∑‡πà‡∏≠ Sheet ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞",
            confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
          });
        }
      }
      // Today tab script (original)
      const sheetIDToday = "1fPzWLyR0xqU30gyIMSuSCuglKEr76AT1ekCR3mY-nrU";
      const sheetNameToday = "ReQuesttoday";
      const urlToday = `https://opensheet.elk.sh/${sheetIDToday}/${sheetNameToday}`;
      const modal = document.getElementById("detailModal");
      const modalContent = document.getElementById("modalContent");
      const closeModal = document.getElementById("closeModal");
      const searchInputToday = document.getElementById("searchInputToday");
      const tableBodyToday = document.querySelector("#data-table-today tbody");
      const errorContainerToday = document.getElementById("error-container-today");
      const retryButtonToday = document.getElementById("retry-button-today");
      let allDataToday = [];
      retryButtonToday.addEventListener("click", () => {
        errorContainerToday.style.display = "none";
        loadTodayData();
      });
      closeModal.onclick = () => {
        modal.style.opacity = "0";
        modal.style.transform = "scale(0.95)";
        setTimeout(() => (modal.style.display = "none"), 300);
      };
      window.onclick = (event) => {
        if (event.target == modal) closeModal.click();
      };
      function renderTableToday(data) {
        tableBodyToday.innerHTML = "";
        data.forEach((row) => {
          const tr = document.createElement("tr");
          const statusTd = document.createElement("td");
          const status = row["Status"] || "";
          statusTd.textContent = status;
          statusTd.className = status === "‡∏™‡∏±‡πà‡∏á‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß" ? "status-green" : "status-red";
          tr.appendChild(statusTd);
          const columns = [
            "Timestamp",
            "Code",
            "Material Description",
            "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô",
            "‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ",
            "‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á",
            "‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô",
            "CallNumber",
            "CallType",
            "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏",
          ];
          columns.forEach((col) => {
            const td = document.createElement("td");
            let value = row[col] || "";
            if (col === "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" || col === "‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ") {
              if (value && !isNaN(value)) {
                value = Number(value).toLocaleString("en-US", { maximumFractionDigits: 0 });
              } else if (value === "0" || value === 0) {
                value = "";
              }
            }
            if (col === "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏" && value) {
              td.style.color = "red";
              td.style.fontWeight = "bold";
            }
            if (col === "Code" && (row["‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"] || "").trim() !== "") {
              td.style.color = "red";
              td.style.fontWeight = "bold";
            }
            if (col === "Material Description" && (row["‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"] || "").trim() !== "") {
              td.style.color = "red";
              td.style.fontWeight = "bold";
            }
            if (col === "Timestamp" && (row["‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"] || "").trim() !== "") {
              td.style.color = "red";
              td.style.fontWeight = "bold";
            }
            if (col === "‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ" && value) {
              td.style.color = "#4caf50"; // Green color
              td.style.fontWeight = "bold";
           }
            td.textContent = value;
            tr.appendChild(td);
          });
          const detailTd = document.createElement("td");
          const btn = document.createElement("button");
          btn.textContent = "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î";
          btn.className = "detail-button";
          btn.onclick = () => {
            modalContent.innerHTML = columns
              .map((col) => {
                let label = "";
                switch (col) {
                  case "Timestamp": label = "üìÖ ‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤"; break;
                  case "Code": label = "üî¢ Material"; break;
                  case "Material Description": label = "üõ†Ô∏è Description"; break;
                  case "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô": label = "üî¢ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô"; break;
                  case "‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á": label = "üë∑‚Äç‚ôÇÔ∏è ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á"; break;
                  case "‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô": label = "üè¢ ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô"; break;
                  case "CallNumber": label = "üìÑ Call"; break;
                  case "CallType": label = "üó≥Ô∏è CallType"; break;
                  case "‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ": label = "üì¶ ‡∏Ñ‡∏•‡∏±‡∏á‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ"; break;
                  case "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏": label = "üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"; break;
                  default: label = col;
                }
                const value = row[col] || "";
                const valueHtml = col === "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏" && value
                  ? `<span class='value' style='color:red'>${value}</span>`
                  : `<span class='value'>${value}</span>`;
                return `<div><span class='label'>${label}:</span> ${valueHtml}</div>`;
              })
              .join("");
            modal.style.display = "block";
            setTimeout(() => {
              modal.style.opacity = "1";
              modal.style.transform = "scale(1)";
            }, 10);
          };
          detailTd.appendChild(btn);
          tr.appendChild(detailTd);
          tableBodyToday.appendChild(tr);
        });
      }
      searchInputToday.addEventListener("input", (e) => {
        const keyword = e.target.value.toLowerCase();
        const filtered = allDataToday.filter((row) => {
          return (
            (row["Code"] || "").toLowerCase().includes(keyword) ||
            (row["Material Description"] || "").toLowerCase().includes(keyword) ||
            (row["‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á"] || "").toLowerCase().includes(keyword) ||
            (row["‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô"] || "").toLowerCase().includes(keyword)
          );
        });
        renderTableToday(filtered);
      });
      async function loadTodayData() {
        document.getElementById("loading").style.display = "flex";
        document.getElementById("loadingToday").style.display = "block";
        errorContainerToday.style.display = "none";
        console.log("Starting data load from:", urlToday);
        try {
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 15000);
          const response = await fetch(urlToday, { signal: controller.signal });
          clearTimeout(timeoutId);
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const data = await response.json();
          console.log("Today data loaded successfully:", data);
          if (!Array.isArray(data) || data.length === 0) {
            throw new Error("No data received or data is empty");
          }
          allDataToday = data;
          renderTableToday(data);
          document.getElementById("loading").style.display = "none";
          document.getElementById("loadingToday").style.display = "none";
          document.getElementById("data-table-today").style.display = "table";
        } catch (error) {
          console.error("Error loading today data:", error);
          document.getElementById("loading").style.display = "none";
          document.getElementById("loadingToday").style.display = "none";
          errorContainerToday.style.display = "block";
          document.getElementById("error-message-today").textContent = error.message.includes("aborted")
            ? "‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠"
            : `‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ${error.message}`;
          Swal.fire({
            icon: "error",
            title: "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
            text: error.message.includes("aborted")
              ? "‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ä‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà"
              : "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Sheet ID, ‡∏ä‡∏∑‡πà‡∏≠ Sheet ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞",
            confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
          });
        }
      }
      // All tab script
      const sheetIDAll = '1fPzWLyR0xqU30gyIMSuSCuglKEr76AT1ekCR3mY-nrU';
      const sheetNameAll = 'ReQuestHistory';
      const urlAll = `https://opensheet.elk.sh/${sheetIDAll}/${sheetNameAll}`;
      const modalAll = document.getElementById("detailModalAll");
      const modalContentAll = document.getElementById("modalContentAll");
      const closeModalAll = document.getElementById("closeModalAll");
      const searchInputAll = document.getElementById("searchInputAll");
      const tableBodyAll = document.querySelector("#data-table-all tbody");
      const pageNumbersContainerAll = document.getElementById("pageNumbersAll");
      const firstPageButtonAll = document.getElementById("firstPageAll");
      const prevPageButtonAll = document.getElementById("prevPageAll");
      const nextPageButtonAll = document.getElementById("nextPageAll");
      const lastPageButtonAll = document.getElementById("lastPageAll");
      const itemsPerPageSelectAll = document.getElementById("itemsPerPageAll");
      let allDataAll = [];
      let currentPageAll = 1;
      let itemsPerPageAll = parseInt(itemsPerPageSelectAll.value);
      closeModalAll.onclick = () => modalAll.style.display = "none";
      window.onclick = event => {
        if (event.target == modalAll) modalAll.style.display = "none";
      };
      itemsPerPageSelectAll.addEventListener("change", (e) => {
        itemsPerPageAll = parseInt(e.target.value);
        currentPageAll = 1;
        renderTableAll(allDataAll);
      });
     function renderTableAll(data) {
        tableBodyAll.innerHTML = '';
        const startIdx = (currentPageAll - 1) * itemsPerPageAll;
        const endIdx = startIdx + itemsPerPageAll;
        const paginatedData = data.slice(startIdx, endIdx);
        paginatedData.forEach((row, i) => {
          const tr = document.createElement("tr");
          tr.style.animationDelay = `${i * 0.05}s`; // Fade-in ‡∏ó‡∏µ‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß
           const status = row["Status"] || "";
          const statusTd = document.createElement("td");
          statusTd.textContent = status;
          statusTd.className = status === "‡∏™‡∏±‡πà‡∏á‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß" ? "status-green" : "status-red";
          tr.appendChild(statusTd);
          const columns = ["Timestamp", "Code", "Material Description", "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô", "‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á", "‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô","CallNumber","CallType", "Note"];
          columns.forEach(col => {
            const td = document.createElement("td");
            td.textContent = row[col] || "";
            tr.appendChild(td);
          });
          const detailTd = document.createElement("td");
          const btn = document.createElement("button");
          btn.textContent = "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î";
          btn.className = "detail-button";
          btn.onclick = () => {
            modalContentAll.innerHTML = columns.map(col => {
              const label = col === "Timestamp" ? "‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤" : col;
              return `<div><span class='label'>${label}:</span> <span class='value'>${row[col] || ''}</span></div>`;
            }).join('');
            modalAll.style.display = "block";
          };
          detailTd.appendChild(btn);
          tr.appendChild(detailTd);
          tableBodyAll.appendChild(tr);
        });
        updatePaginationAll(data);
      }
      function updatePaginationAll(data) {
        const totalPages = Math.ceil(data.length / itemsPerPageAll);
        pageNumbersContainerAll.innerHTML = '';
        const startPage = currentPageAll; // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
        const endPage = Math.min(totalPages, currentPageAll + 2); // ‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å 2 ‡∏´‡∏ô‡πâ‡∏≤
        for (let i = startPage; i <= endPage; i++) {
          const pageNumberButton = document.createElement("button");
          pageNumberButton.className = `all-page-number ${i === currentPageAll ? 'active' : ''}`;
          pageNumberButton.textContent = i;
          pageNumberButton.onclick = () => {
            currentPageAll = i;
            renderTableAll(data);
          };
          pageNumbersContainerAll.appendChild(pageNumberButton);
        }
      }
      // ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
      firstPageButtonAll.onclick = () => {
        currentPageAll = 1;
        renderTableAll(allDataAll);
      };
      // ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
      prevPageButtonAll.onclick = () => {
        if (currentPageAll > 1) {
          currentPageAll--;
          renderTableAll(allDataAll);
        }
      };
      // ‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ next
      nextPageButtonAll.onclick = () => {
        const totalPages = Math.ceil(allDataAll.length / itemsPerPageAll);
        if (currentPageAll < totalPages) {
          currentPageAll++;
          renderTableAll(allDataAll);
        }
      };
      // ‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢
      lastPageButtonAll.onclick = () => {
        currentPageAll = Math.ceil(allDataAll.length / itemsPerPageAll);
        renderTableAll(allDataAll);
      };
      searchInputAll.addEventListener("input", e => {
        const keyword = e.target.value.toLowerCase();
        const filtered = allDataAll.filter(row => {
          return (
            (row["Code"] || "").toLowerCase().includes(keyword) ||
            (row["Material Description"] || "").toLowerCase().includes(keyword) ||
            (row["‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á"] || "").toLowerCase().includes(keyword) ||
            (row["‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô"] || "").toLowerCase().includes(keyword) ||
            (row["‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"] || "").toLowerCase().includes(keyword)
          );
        });
        renderTableAll(filtered);
      });
      function loadAllData() {
        fetch(urlAll)
          .then(response => response.json())
          .then(data => {
            allDataAll = data;
            renderTableAll(data);
          })
          .catch(error => {
            console.error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ:", error);
          });
      }
      // Pending-calls tab script
      const sheetIDPending = '1dzE4Xjc7H0OtNUmne62u0jFQT-CiGsG2eBo-1v6mrZk';
      const sheetNamePending = 'Call_Report';
      const urlPending = `https://opensheet.elk.sh/${sheetIDPending}/${sheetNamePending}`;
      const modalPending = document.getElementById("detailModalPending");
      const modalContentPending = document.getElementById("modalContentPending");
      const closeModalPending = document.getElementById("closeModalPending");
      const teamFilterPending = document.getElementById("teamFilterPending");
      const searchInputPending = document.getElementById("searchInputPending");
      const searchButtonPending = document.getElementById("searchButtonPending");
      const tableBodyPending = document.querySelector("#data-table-pending tbody");
      const pageNumbersContainerPending = document.getElementById("pageNumbersPending");
      const firstPageButtonPending = document.getElementById("firstPagePending");
      const prevPageButtonPending = document.getElementById("prevPagePending");
      const nextPageButtonPending = document.getElementById("nextPagePending");
      const lastPageButtonPending = document.getElementById("lastPagePending");
      const itemsPerPageSelectPending = document.getElementById("itemsPerPagePending");
      let allDataPending = [];
      let currentPagePending = 1;
      let itemsPerPagePending = 20;
      let sortConfigPending = { column: null, direction: 'asc' };
      closeModalPending.onclick = () => modalPending.style.display = "none";
      window.onclick = event => {
        if (event.target == modalPending) modalPending.style.display = "none";
      };
      itemsPerPageSelectPending.addEventListener("change", (e) => {
        itemsPerPagePending = parseInt(e.target.value);
        currentPagePending = 1; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤
        filterAndRenderTablePending();
      });
      searchInputPending.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          currentPagePending = 1; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏´‡∏°‡πà
          filterAndRenderTablePending();
        }
      });
      searchButtonPending.addEventListener("click", () => {
        currentPagePending = 1; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏´‡∏°‡πà
        filterAndRenderTablePending();
      });
      function populateTeamFilterPending(data) {
        const filteredData = data.filter(row => {
          const vipa = Number(row["Vipa"] || 0);
          const pendingDept = (row["‡∏Ñ‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô"] || "").toLowerCase();
          return vipa > 0 &&
                 !pendingDept.includes("stock ‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ 62") &&
                 !pendingDept.includes("nec_‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ú‡∏•‡∏¥‡∏ï");
        });
        const teams = [...new Set(filteredData.map(row => row["Team"]).filter(team => team && team.trim() !== ""))].sort();
        teamFilterPending.innerHTML = '<option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>';
        if (teams.length === 0) {
          const option = document.createElement("option");
          option.value = "";
          option.textContent = "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç";
          option.disabled = true;
          teamFilterPending.appendChild(option);
        } else {
          teams.forEach(team => {
            const option = document.createElement("option");
            option.value = team;
            option.textContent = team;
            teamFilterPending.appendChild(option);
          });
        }
      }
      function addSortListenersPending() {
        const sortableHeaders = document.querySelectorAll("#pending-calls th.sortable");
        sortableHeaders.forEach(header => {
          header.addEventListener("click", () => {
            const column = header.getAttribute("data-column");
            if (sortConfigPending.column === column) {
              sortConfigPending.direction = sortConfigPending.direction === 'asc' ? 'desc' : 'asc';
            } else {
              sortConfigPending.column = column;
              sortConfigPending.direction = 'asc';
            }
            updateSortArrowsPending();
            filterAndRenderTablePending();
          });
        });
      }
      function updateSortArrowsPending() {
        const sortableHeaders = document.querySelectorAll("#pending-calls th.sortable");
        sortableHeaders.forEach(header => {
          const arrow = header.querySelector(".pending-arrow");
          const column = header.getAttribute("data-column");
          if (column === sortConfigPending.column) {
            arrow.textContent = sortConfigPending.direction === 'asc' ? '‚Üë' : '‚Üì';
          } else {
            arrow.textContent = '';
          }
        });
      }
      function filterAndRenderTablePending() {
        const selectedTeam = teamFilterPending.value;
        const keyword = searchInputPending.value.toLowerCase().trim();
        let filteredData = allDataPending.filter(row => {
          const pendingDept = (row["‡∏Ñ‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô"] || "").toLowerCase();
          return Number(row["Vipa"] || 0) > 0 &&
                 !pendingDept.includes("stock ‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ 62") &&
                 !pendingDept.includes("nec_‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ú‡∏•‡∏¥‡∏ï") &&
                 (!selectedTeam || row["Team"] === selectedTeam) &&
                 (!keyword ||
                   (row["DateTime"] || "").toLowerCase().includes(keyword) ||
                   (row["Ticket Number"] || "").toLowerCase().includes(keyword) ||
                   (row["Team"] || "").toLowerCase().includes(keyword) ||
                   (row["Brand"] || "").toLowerCase().includes(keyword) ||
                   (row["‡∏Ñ‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô"] || "").toLowerCase().includes(keyword) ||
                   (row["Material"] || "").toLowerCase().includes(keyword) ||
                   (row["Description"] || "").toLowerCase().includes(keyword) ||
                   (row["Vipa"] || "").toLowerCase().includes(keyword) ||
                   (row["DayRepair"] || "").toLowerCase().includes(keyword)
                 );
        });
        if (sortConfigPending.column) {
          filteredData.sort((a, b) => {
            let valueA = a[sortConfigPending.column] || "";
            let valueB = b[sortConfigPending.column] || "";
            if (sortConfigPending.column === 'DayRepair' || sortConfigPending.column === 'Vipa') {
              valueA = Number(valueA) || 0;
              valueB = Number(valueB) || 0;
              return sortConfigPending.direction === 'asc' ? valueA - valueB : valueB - valueA;
            } else {
              valueA = valueA.toString().toLowerCase();
              valueB = valueB.toString().toLowerCase();
              return sortConfigPending.direction === 'asc' ? valueA.localeCompare(valueB) : valueB.localeCompare(valueA);
            }
          });
        }
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ currentPage ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
        const totalPages = Math.ceil(filteredData.length / itemsPerPagePending);
        if (currentPagePending > totalPages) {
          currentPagePending = totalPages || 1;
        }
        renderTablePending(filteredData);
        updateCallCountPending(filteredData);
      }
      teamFilterPending.addEventListener("change", () => {
        currentPagePending = 1; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ó‡∏µ‡∏°
        filterAndRenderTablePending();
      });
      function updateCallCountPending(data) {
        const uniqueTickets = [...new Set(data.map(row => row["Ticket Number"]))];
        const count = uniqueTickets.length;
        const callCountValue = document.getElementById("callCountValuePending");
        callCountValue.textContent = count;
      }
      function formatDateTimePending(dateTime) {
        if (!dateTime) return "";
        const datePart = dateTime.split(" ")[0];
        return datePart;
      }
      function renderTablePending(data) {
        tableBodyPending.innerHTML = '';
        const startIdx = (currentPagePending - 1) * itemsPerPagePending;
        const endIdx = startIdx + itemsPerPagePending;
        const paginatedData = data.slice(startIdx, endIdx);
        if (paginatedData.length === 0) {
          tableBodyPending.innerHTML = '<tr><td colspan="10" class="pending-text-center">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</td></tr>';
          updatePaginationPending(data);
          return;
        }
        const ticketGroups = {};
        data.forEach(row => {
          const ticket = row["Ticket Number"];
          if (!ticketGroups[ticket]) {
            ticketGroups[ticket] = [];
          }
          ticketGroups[ticket].push(row);
        });
        const uniqueTickets = Object.keys(ticketGroups).sort();
        const colorMap = {};
        uniqueTickets.forEach((ticket, index) => {
          if (ticket === "24103102058") {
            colorMap[ticket] = "pending-yellow-light";
          } else if (ticket === "25011101274") {
            colorMap[ticket] = "pending-pink-pastel";
          } else {
            colorMap[ticket] = index % 2 === 0 ? "pending-yellow-light" : "pending-pink-pastel";
          }
        });
        paginatedData.forEach((row, i) => {
          const tr = document.createElement("tr");
          tr.style.animationDelay = `${i * 0.05}s`;
          const ticket = row["Ticket Number"];
          tr.className = colorMap[ticket];
          const columns = ["DateTime", "Ticket Number", "Team", "Brand", "‡∏Ñ‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô", "Material", "Description", "Vipa", "DayRepair"];
          columns.forEach(col => {
            const td = document.createElement("td");
            let cellValue = row[col] || "";
            if (col === "DateTime") {
              cellValue = formatDateTimePending(cellValue);
            } else if (col === "DayRepair" || col === "Vipa") {
              const numValue = Number(cellValue);
              cellValue = isNaN(numValue) ? "" : numValue.toString();
            }
            td.textContent = cellValue;
            if (col === "Description") {
              td.classList.add("pending-text-left");
            } else if (col === "Vipa" || col === "DayRepair") {
              td.classList.add("pending-text-center");
            }
            if ((col === "Material" || col === "Description") && row["Description"] === "Code ‡∏ú‡∏¥‡∏î") {
              td.className = "pending-highlight-red";
            }
            tr.appendChild(td);
          });
          const detailTd = document.createElement("td");
          const btn = document.createElement("button");
          btn.textContent = "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î";
          btn.className = "pending-detail-button";
          btn.onclick = () => {
            modalContentPending.innerHTML = columns.map(col => {
              let value = row[col] || "";
              if (col === "DateTime") {
                value = formatDateTimePending(value);
              } else if (col === "DayRepair" || col === "Vipa") {
                const numValue = Number(value);
                value = isNaN(numValue) ? "" : numValue.toString();
              }
              let valueClass = (col === "Material" || col === "Description") && row["Description"] === "Code ‡∏ú‡∏¥‡∏î" ? "pending-highlight-red" : "value";
              return `<div><span class='label'>${col}:</span> <span class='${valueClass}'>${value}</span></div>`;
            }).join('');
            modalPending.style.display = "block";
          };
          detailTd.appendChild(btn);
          tr.appendChild(detailTd);
          tableBodyPending.appendChild(tr);
        });
        updatePaginationPending(data);
      }
      function updatePaginationPending(data) {
        const totalPages = Math.ceil(data.length / itemsPerPagePending);
        pageNumbersContainerPending.innerHTML = '';
        if (totalPages === 0) {
          firstPageButtonPending.disabled = true;
          prevPageButtonPending.disabled = true;
          nextPageButtonPending.disabled = true;
          lastPageButtonPending.disabled = true;
          return;
        }
        const startPage = Math.max(1, currentPagePending - 1);
        const endPage = Math.min(totalPages, currentPagePending + 2);
        for (let i = startPage; i <= endPage; i++) {
          const pageNumberButton = document.createElement("button");
          pageNumberButton.className = `pending-page-number ${i === currentPagePending ? 'active' : ''}`;
          pageNumberButton.textContent = i;
          pageNumberButton.onclick = () => {
            currentPagePending = i;
            filterAndRenderTablePending();
          };
          pageNumbersContainerPending.appendChild(pageNumberButton);
        }
        firstPageButtonPending.disabled = currentPagePending === 1;
        prevPageButtonPending.disabled = currentPagePending === 1;
        nextPageButtonPending.disabled = currentPagePending === totalPages;
        lastPageButtonPending.disabled = currentPagePending === totalPages;
      }
      firstPageButtonPending.onclick = () => {
        currentPagePending = 1;
        filterAndRenderTablePending();
      };
      prevPageButtonPending.onclick = () => {
        if (currentPagePending > 1) {
          currentPagePending--;
          filterAndRenderTablePending();
        }
      };
      nextPageButtonPending.onclick = () => {
        const totalPages = Math.ceil(allDataPending.filter(row => {
          const pendingDept = (row["‡∏Ñ‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô"] || "").toLowerCase();
          return Number(row["Vipa"] || 0) > 0 &&
                 !pendingDept.includes("stock ‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ 62") &&
                 !pendingDept.includes("nec_‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ú‡∏•‡∏¥‡∏ï");
        }).length / itemsPerPagePending);
        if (currentPagePending < totalPages) {
          currentPagePending++;
          filterAndRenderTablePending();
        }
      };
      lastPageButtonPending.onclick = () => {
        currentPagePending = Math.ceil(allDataPending.filter(row => {
          const pendingDept = (row["‡∏Ñ‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô"] || "").toLowerCase();
          return Number(row["Vipa"] || 0) > 0 &&
                 !pendingDept.includes("stock ‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ 62") &&
                 !pendingDept.includes("nec_‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ú‡∏•‡∏¥‡∏ï");
        }).length / itemsPerPagePending);
        filterAndRenderTablePending();
      };
      function loadPendingCallsData() {
        fetch(urlPending)
          .then(response => response.json())
          .then(data => {
            allDataPending = data;
            populateTeamFilterPending(allDataPending);
            addSortListenersPending();
            filterAndRenderTablePending();
          })
          .catch(error => {
            console.error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ:", error);
            tableBodyPending.innerHTML = '<tr><td colspan="10" class="pending-text-center">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
          });
      }
      loadData();
    </script>
  </body>
</html>
